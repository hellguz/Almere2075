/*
  File: /frontend/src/views/CommunityGalleryView.css
  Final, comprehensive style fix for the gallery.
*/

/* --- Main View Container (styles from previous fix are correct) --- */
.community-gallery-view {
    display: flex;
    flex-direction: column;
    height: 100%;
    width: 100%;
    background: #080808;
    box-sizing: border-box;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.8s ease, visibility 0.8s;
    will-change: opacity;
}
.community-gallery-view.visible {
    opacity: 1;
    visibility: visible;
}

/* --- Header Text --- */
.gallery-info-text {
    flex-shrink: 0; 
    padding: 85px 15px 15px;
    text-align: center;
    color: var(--color-text-secondary);
    font-size: 0.9rem;
}


/* --- Scrollable Grid Container --- */
.gallery-grid-container {
    flex-grow: 1;
    overflow-y: auto;
    min-height: 0;
    padding: 15px;
    box-sizing: border-box;

    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 24px;

    /*
      ======================================================================
      === THE DEFINITIVE ROOT CAUSE FIX ===
      ======================================================================
      'grid-auto-rows: min-content' is the critical change. It forces each
      row in the grid to be only as tall as the content inside it. This
      prevents the cards from stretching vertically to fill the screen and
      ensures they have a constant height, which finally allows the
      container to scroll correctly.
    */
    grid-auto-rows: min-content;
}


/* --- Gallery Card --- */
.gallery-item {
    background: #1c1c1e;
    border-radius: 12px;
    border: 1px solid #2c2c2e;
    overflow: hidden;
    cursor: pointer;
    transition: transform 0.2s ease, border-color 0.2s ease;
    display: flex;
    flex-direction: column;
}
.gallery-item:hover {
    transform: translateY(-5px);
    border-color: var(--color-system);
}


/* --- Card Image Container --- */
.gallery-item-images {
    position: relative;
    width: 100%;
    /* This forces the 1:1 aspect ratio and works now that the card height is not being stretched. */
    aspect-ratio: 1 / 1;
    flex-shrink: 0; /* Prevents image container from squashing */
    overflow: hidden;
}
.gallery-item-images > img {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    object-fit: cover;
    transition: opacity 0.4s ease-in-out;
}

/* Image hover effect */
.gallery-item-thumb.generated { opacity: 1; }
.gallery-item:hover .gallery-item-thumb.generated { opacity: 0; }
.gallery-item-thumb.original { opacity: 0; }
.gallery-item:hover .gallery-item-thumb.original { opacity: 1; }


/* --- Card Info Section --- */
.gallery-item-info {
    padding: 15px;
    display: flex;
    flex-wrap: wrap; /* Allows items to wrap on very narrow screens */
    justify-content: space-between;
    align-items: center;
    gap: 10px;
}
.gallery-item-details {
    flex-grow: 1;
}
.gallery-item-tags {
    font-weight: bold;
    font-size: 0.95rem;
}
.gallery-item-creator {
    color: var(--color-text-secondary);
    font-size: 0.85rem;
}
.like-button {
    background: #333;
    color: white;
    border: 1px solid #555;
    padding: 10px 15px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    flex-shrink: 0; /* Prevents button from shrinking */
}
.like-button:hover {
    background: var(--color-system);
    border-color: var(--color-system);
}


/* --- Modal & Scrollbar Styles (Unchanged) --- */
.modal-overlay { 
    position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
    background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); 
    z-index: 200; display: flex; align-items: center; justify-content: center;
}
.modal-content { 
    position: relative; width: 95%; height: 90%; 
    background: var(--color-background); border-radius: 16px; 
    overflow: hidden; display: flex; flex-direction: column; 
}
.modal-header { 
    position: absolute; top: 15px; right: 15px; z-index: 20; 
    display: flex; gap: 10px;
}
.close-modal-button { 
    background: var(--liquid-bg); color: white; border: 1px solid var(--liquid-border); 
    border-radius: 50%; width: 40px; height: 40px; font-size: 20px; 
    cursor: pointer; backdrop-filter: blur(var(--liquid-blur)); 
    display: flex; align-items: center; justify-content: center;
}
.gallery-grid-container::-webkit-scrollbar { width: 6px; }
.gallery-grid-container::-webkit-scrollbar-track { background: transparent; }
.gallery-grid-container::-webkit-scrollbar-thumb { background: var(--scrollbar-thumb-bg); border-radius: 3px; }
.gallery-grid-container::-webkit-scrollbar-thumb:hover { background: var(--scrollbar-thumb-hover-bg); }


/* --- Responsive (Unchanged) --- */
@media (max-width: 768px) {
  .gallery-grid-container {
      grid-template-columns: 1fr;
      justify-items: center;
  }
  .gallery-item {
      width: 100%;
      max-width: 400px;
  }
}